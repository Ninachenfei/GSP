(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/store/release"],{"1f05":function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(s("427c")),a=l(s("4cba"));function l(e){return e&&e.__esModule?e:{default:e}}function n(e){return o(e)||c(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(e){if(Array.isArray(e)){for(var t=0,s=new Array(e.length);t<e.length;t++)s[t]=e[t];return s}}var u={components:{mpvuePicker:a.default,wPicker:i.default},data:function(){return{pickerValueDefault:[0,0],deepLength:2,selectIndex:[0,0],clsList:[],imgs:[],title:"",price:"",freight:"",stock:"",selsectClsId:0,clsTxt:"",id:""}},computed:{},onLoad:function(e){e.id?(this.id=e.id,this.getData()):this.getAllCls()},created:function(){},methods:{getData:function(){var e=this;this.$post("api/shop/business/publishdetail",{id:this.id}).then(function(t){if(1==t.code){var s=t.data;e.title=s.title,e.price=s.price,e.freight=s.freight,e.stock=s.stock,e.selsectClsId=s.goods_type,e.getAllCls(s.goods_type)}else e.$toast(t.msg),e.getAllCls()})},onConfirm:function(e){this.selsectClsId=e.value[1],this.clsTxt=e.label},showClsList:function(){this.$refs.mpvuePicker.show()},getAllCls:function(t){var s=this;this.clsList=e.getStorageSync("product_goodstypetree")||[],this.$post("api/shop/product/goodstypetree",{pid:0}).then(function(i){if(1==i.code){var a=[];i.data.forEach(function(e){var i={value:e.id,label:e.name,children:[]};e.child&&e.child.length>0?e.child.forEach(function(a){t==a.id&&(s.clsTxt=e.name+"-"+a.name),i.children.push({value:a.id,label:a.name})}):i.children.push({value:e.id,label:e.name}),a.push(i)}),s.clsList=a,e.setStorageSync("product_goodstypetree",a)}else s.$toast(i.msg)})},submit:function(){var t=this;if(this.title)if(this.price)if(this.freight)if(this.stock)if(this.selsectClsId)if(!this.imgs||this.imgs.length<=0)this.$toast("请选择商品轮播图");else{var s=[];this.imgs.forEach(function(e,t){s.push({name:"images_".concat(t),uri:e})}),e.showLoading({title:"正在上传"});var i={token:e.getStorageSync("token"),title:this.title,price:this.price,freight:this.freight,stock:this.stock,goods_type:this.selsectClsId};this.id&&(i.id=this.id),setTimeout(e.hideLoading,15e3),e.uploadFile({url:this.$domain+"api/shop/business/publish",files:s,formData:i,success:function(s){s=JSON.parse(s.data);1==s.code&&e.navigateBack({delta:1}),t.$toast(s.msg)},complete:function(t){e.hideLoading()}}),this.price=""}else this.$toast("请选择商品分类");else this.$toast("请输入商品库存");else this.$toast("请输入商品运费");else this.$toast("请输入商品价格");else this.$toast("请输入商品名称")},addImg:function(){var t=this;if(this.imgs.length>=8)return this.$toast("最多添加8张图"),!1;e.chooseImage({count:8-this.imgs.length,sizeType:["compressed"],sourceType:["album"],success:function(e){var s;(s=t.imgs).push.apply(s,n(e.tempFilePaths))}})},removeImg:function(e){this.imgs.splice(e,1)},previewImgae:function(t){e.previewImage({urls:this.imgs,current:this.imgs[t]})}}};t.default=u}).call(this,s("6e42")["default"])},"2aea":function(e,t,s){"use strict";s.r(t);var i=s("1f05"),a=s.n(i);for(var l in i)"default"!==l&&function(e){s.d(t,e,function(){return i[e]})}(l);t["default"]=a.a},"670e":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"release-page gray-bg"},[s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("商品标题")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],staticClass:"release-input",attrs:{type:"text",placeholder:"请输入商品标题",eventid:"ecef53b0-0"},domProps:{value:e.title},on:{input:function(t){t.target.composing||(e.title=t.target.value)}}})]),s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("商品价格")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],staticClass:"release-input",attrs:{type:"number",placeholder:"请输入商品价格",eventid:"ecef53b0-1"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}})]),s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("商品数量")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.stock,expression:"stock"}],staticClass:"release-input",attrs:{type:"number",placeholder:"请输入商品数量",eventid:"ecef53b0-2"},domProps:{value:e.stock},on:{input:function(t){t.target.composing||(e.stock=t.target.value)}}})]),s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("商品运费")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.freight,expression:"freight"}],staticClass:"release-input",attrs:{type:"number",placeholder:"请输入商品运费",eventid:"ecef53b0-3"},domProps:{value:e.freight},on:{input:function(t){t.target.composing||(e.freight=t.target.value)}}})]),s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("请选择商品分类")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.clsTxt,expression:"clsTxt"}],staticClass:"release-input",attrs:{disabled:"",type:"text",placeholder:"请选择商品分类",eventid:"ecef53b0-4"},domProps:{value:e.clsTxt},on:{click:e.showClsList,input:function(t){t.target.composing||(e.clsTxt=t.target.value)}}})]),s("view",{staticClass:"release-item"},[s("text",{staticClass:"release-item-subtitle"},[e._v("上传详情图片")]),s("view",{staticClass:"release-imgs"},[e._l(e.imgs,function(t,i){return s("view",{key:i,staticClass:"release-img-item"},[s("text",{staticClass:"iconfont release-close",attrs:{eventid:"ecef53b0-5-"+i},on:{click:function(t){e.removeImg(i)}}},[e._v("")]),s("image",{staticClass:"release-img",attrs:{src:t,mode:"aspectFit",eventid:"ecef53b0-6-"+i},on:{click:function(t){e.previewImgae(i)}}})])}),s("view",{staticClass:"release-add-icon",attrs:{eventid:"ecef53b0-7"},on:{click:e.addImg}},[s("text",{staticClass:"iconfont"},[e._v("")])])],2)]),s("view",{staticClass:"plr30"},[s("button",{staticClass:"btn-block",attrs:{"hover-class":"btn-hover",eventid:"ecef53b0-8"},on:{click:e.submit}},[e._v("确认发布")])],1),e.clsList&&e.clsList.length>0?[s("mpvue-picker",{ref:"mpvuePicker",attrs:{mode:"multiLinkageSelector",deepLength:e.deepLength,pickerValueDefault:e.pickerValueDefault,pickerValueArray:e.clsList,eventid:"ecef53b0-9",mpcomid:"ecef53b0-0"},on:{onConfirm:e.onConfirm}})]:e._e()],2)},a=[];s.d(t,"a",function(){return i}),s.d(t,"b",function(){return a})},"864b":function(e,t,s){"use strict";s("263f");var i=l(s("b0ce")),a=l(s("d707"));function l(e){return e&&e.__esModule?e:{default:e}}Page((0,i.default)(a.default))},d707:function(e,t,s){"use strict";s.r(t);var i=s("670e"),a=s("2aea");for(var l in a)"default"!==l&&function(e){s.d(t,e,function(){return a[e]})}(l);var n=s("2877"),r=Object(n["a"])(a["default"],i["a"],i["b"],!1,null,"6093e3fe",null);t["default"]=r.exports}},[["864b","common/runtime","common/vendor"]]]);